{% extends "basic/layout.html" %}

{% macro relbar() %}
    {% if theme_showbreadcrumbs == 'true' %}

    {% endif %}
{% endmacro %}


<!-- Sphinx also brings it's own jquery, but this one is too old for bootstrap.
    TODO get rid of the one from Sphinx -->
<!-- we copied the bootstrap/jquery.js to the _static directory to override the
    sphinx jquery. The native
    jquery.js from sphinx is a 1.4 version, while bootstrap uses 1.8 version
    and two versions together clash (besides the bootstrap stuff, also the 
    sphinx search stuff)  -->
{#% set script_files = script_files + ['_static/bootstrap/js/jquery.js'] %#}
{% set script_files = script_files + ['_static/bootstrap/js/bootstrap.js'] %}

{% set css_files = css_files + ['_static/bootstrap/css/bootstrap.min.css'] %}
<!-- qgis.css BEFORE bootstrap-responsive -->
{% set css_files = css_files + ['_static/qgis.css'] %}
{% set css_files = css_files + ['_static/bootstrap/css/bootstrap-responsive.min.css'] %}


{% block extrahead %}
    <!-- without this part, the responsive-css for bootstrap kill some rules
        TODO: remove this, or make this obsolete ?? -->
    <style>
    .navbar-fixed-top .navbar-inner, .navbar-fixed-bottom .navbar-inner {
        padding-bottom: 0px;
        padding-left: 0px;
        padding-right: 0px;
        padding-top: 0px;
    }
    .navbar .brand {
        background-image: url("{{ pathto('_static/img/logo.png', 1)}}");
        background-repeat: no-repeat;
        height: 42px;
        padding-left: 60px;
    }
    .navbar-inverse .navbar-inner {
        background-color:none;
    }
    </style>

    <script>
        // put a line below the current locale flag
        $(document).ready(function(){
            var currentPage = '{{current_page_name}}.html';
            var currentLang = window.location.href.slice(window.location.href.indexOf(currentPage)-3 ,window.location.href.indexOf(currentPage)-1);
            //$('#flag_'+currentLang).css('border-bottom', 'solid 1px #111111');
            $('#flag_'+currentLang).css('background-color', '#cccccc');
        })

        // load current page in a different language
        function gotoLang(lang){
            var currentPage = '{{current_page_name}}.html';
            var baseUrl = window.location.href.slice(0,window.location.href.indexOf(currentPage)-3); // -3 removes current locale 
            window.location.href = baseUrl + lang + '/' + currentPage;
        }
    </script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="shortcut icon" href="_static/img/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="{{ pathto('_static/bootstrap/img/apple-touch-icon-114x114-precomposed.png', 1)}}">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="{{ pathto('_static/bootstrap/img/apple-touch-icon-72x72-precomposed.png', 1)}}">
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="{{ pathto('_static/bootstrap/img/apple-touch-icon-57x57-precomposed.png', 1)}}">
    <link rel="apple-touch-icon-precomposed" href="{{ pathto('_static/bootstrap/img/apple-touch-icon-57x57-precomposed.png', 1)}}">
{% endblock %}

{# overriding relbar1: NO relbar above the content #}
{% block relbar1 %}{% endblock %}

{% block content %}

    {# bootstrap stuff from fluid.html example #}
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar">Extra Link</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#"></a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a href="http://inasafe.org">InaSAFE Home</a></li>
              <li class="active"><a href="{{ pathto(master_doc) }}">Documentation</a></li>
              <li><a href="https://github.com/AIFDR/inasafe/issues">Report an issue</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
      {# Manually implementing breadcrumbs because sphinx strips markup away when doing it in macro #}
      <div class="related">
	<ul class="breadcrumb" id="breadcrumbs">
	  {# These are the prev | next | index links to the right #}
          {% for rellink in rellinks %}
          <li class="right" {% if loop.first %}style="margin-right: 10px"{% endif %}>
            <a href="{{ pathto(rellink[0]) }}" title="{{ rellink[1]|striptags }}"  style="z-index:{{ loop.counter }};" {{ accesskey(rellink[2]) }}>{{ rellink[3] }}</a>
          </li>
          {% endfor %}

          {# Static breadcrumb first entry now #}
          <li class="first">
            <a style="z-index:100;" href="{{ pathto(master_doc) }}"> {{ shorttitle|e }} </a>
          </li>
          {# auto breadcrumbs on the left comes now #} 
          {% for parent in parents %}
          <li>
            <a href="{{ parent.link|e }}" style="z-index:{{loop.revcounter}};" {% if loop.last %}{{ accesskey("U") }}{% endif %}>{{ loop.revcounter }}{{ parent.title }}</a>
          </li>
          {% endfor %}
          <li><a href="#">{{ title }}</a></li>
        </ul> {# Breadcrumbs end #}
      </div> {# Related div end #}
    </div> {# Navbar ends #}
   
    <!-- bootstrap stuff from fluid.html example -->
    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span2">
          <div class="well sidebar-nav">
            <!-- sidebar -->
            <ul id="locales">
                <!-- TODO: get the flag images from a central place  -->
                <li id="flag_en"><a href="#" onclick="gotoLang('en');"><img src="{{ pathto('_static/img/flags/gb.png', 1)}}"/></a></li>
                <li id="flag_id"><a href="#" onclick="gotoLang('id');"><img src="{{ pathto('_static/img/flags/id.png', 1)}}"/></a></li>
            </ul><span style="clear:both">&nbsp;</span>
            {%- if sidebars != None %}
                {#- new style sidebar: explicitly include/exclude templates #}
                {%- for sidebartemplate in sidebars %}
                {%- include sidebartemplate %}
                {%- endfor %}
            {%- endif %}
          </div><!--/.well -->
        </div><!--/span-->
        <div class="span10">
          <div cclass="hero-unit">

            {% block body %} {% endblock %}

          </div>
        </div><!--/span-->
      <hr>
    </div><!--/.fluid-container-->
{% endblock %}

